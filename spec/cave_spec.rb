require "spec_helper"
require "cave"
require "pry"

RSpec.describe Cave do
  let(:cave)         { Cave.new(input) }
  let(:input)        { StringIO.new(cave_type) }

  describe "#pump" do
    context "when asked for depths for a simple cave" do
      let(:cave_type) { simple_cave }

      before { cave.pump }

      it "returns the correct depths" do
        expect(cave.depths).to eq(simple_depths)
      end
    end

    context "when asked for depths for a complex cave" do
      let(:cave_type) { complex_cave }

      before { cave.pump }

      it "returns the correct depths" do
        expect(cave.depths).to eq(complex_depths)
      end
    end
  end

  def complex_depths
    "1 12 1 5 8 8 9 10 17 17 18 20 24 24 24 24 24 24 32 32 32 32 32 32 32 32 9 5 1 1 9 11 29 30 32 32 32 32 32 22 20 19 18 13 10 10 8 4 4 3 3 19 19 20 21 23 23 24 24 26 32 32 32 32 32 32 32 22 22 22 21 21 21 6 6 2 1 1 1 1 1 1 1 32 30 30 30 8 8 5 5 2 2 2 8 19 19 19 20 21 26 26 27 28 28 29 29 30 30 30 30 30 30 30 30 30 30 30 30 30 17 16 15 15 15 11 8 8 6 6 6 1 1 1 1 ~ 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"
  end

  def simple_depths
    "1 2 2 4 4 4 4 6 6 6 1 1 1 1 4 3 3 4 4 4 4 5 5 5 5 5 2 2 1 1 0 0"
  end

  def simple_cave
    "100

################################
~                              #
#         ####                 #
###       ####                ##
###       ####              ####
#######   #######         ######
#######   ###########     ######
################################
"
  end

  def complex_cave
    "2461

#####################################################################################################################################################################################################
~                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
#                                                                                                                                                                                                   #
###                         ##                                              #######                                                                                         ####                    #
###                         ##                                             ########                                                                                         ####                    #
###                         ##                   ##                        ########                                                ####                                     ####                    #
###                         ##                 ####                        ########        ###                                     ####                                     ####                    #
####                       ###                 ####                        ########        ###                                     ####                                     ####                    #
####                       ###                 ####                      ##########        ###                                     ####                                     ####                    #
####                       ###                 ####                      ##########      #####                                     ####                                     ####                    #
######                     ###                #####                      ##########      #####                                  #######                                     ####                    #
#######                   #####               #####                      ##########      #####                                  #######                                     ####  ########          #
########                  #####             #######                      ##########    ########                               #########                  ######             ####  ########          #
########                  ######            #######                      ##########    ########                               ##########                 ######             ####  ########          #
########                  ######            #######                      ##########    ########                               ##########                 ######             ####  ########          #
########                  ######           ########                      ##########    ########                              ###########                 ######             ####  ########          #
########                  ######           ########                      ##########    ########                              ############                ######             ####  ########          #
########                  ######           ########                      ##########    ########                              ############                ######             ####  ########          #
########                  ######           ########                      ##########    ########                              ############             #########             ####  ########          #
##########                ######           ########                      ##########    ########                           ###############          ############             ####  ########          #
###########               ######          #########                      ##########    ########                          ################         #############             ####  ########          #
###########               ######         ############                    ##########    ########                         #################         #############             ##############          #
############              ######        ##############                   ##########    ########                         #################        ##############             ##############          #
############              ######        ###############               #############    ###########                      #################        ##############             ##############          #
############              ######       ################            ################    ############                     #################        ##############             #################       #
############              ######       ##################          ################    #############                    #################        ##############             #################       #
##################        ######       ####################        ################    #############                    #################        ##############            ####################     #
##################        ######       ####################        ################    #############                    #################        ##############            ######################   #
##################        ######       #####################       ################    #############                    #################        ##############            ######################   #
##################        ######       #####################       ################    #############                    #################        ##############            #######################  #
##################        ######       #####################       ################    ###############                  #################        ##############            #######################  #
##################        #######      #####################       ################    ################                 #################        ##############            #######################  #
##################        ########     #####################       ################    ##################               #################        ##############           ########################  #
##################        ########     #####################       ################    ####################             #################        ##############          #########################  #
#####################################################################################################################################################################################################"
  end
end
